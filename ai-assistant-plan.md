# AIアシスタント機能実装方針

打ち合わせシートの項目への入力を支援するインタビューチャット形式のAIアシスタント機能を導入する。

## 機能

- AIアシスタントを起動すると、「こんにちは！ BRIDGE AIアシスタントです。先生と司書をつなぐお手伝いをします。」と挨拶する。
  - 目的は、打ち合わせシートの構造に準拠して、授業や打ち合わせの内容を正確に把握し、必要な情報を漏れなく効率的に収集することです。
  - 対話式で質問を行いながら、ユーザーが回答した内容を整理して、打ち合わせシートの対応する項目に自動的に入力する。
  - 選択肢を持つ項目については、ユーザーに選択肢を提示し、適切な選択を促す。
- 大きな処理の流れは以下の通りです。
  1. 打ち合わせシートの情報を取得する。
  2. 打ち合わせシートの情報と過去のやりとりを生成AIに渡して、ユーザーへの質問を作成し、提示する。
  3. ユーザーの回答を受け取り、生成AIが改めて、打ち合わせシートの情報を踏まえて解析した上で、打ち合わせシートの対応する項目に情報を反映する。
  4. すべての必要な情報が収集される、もしくは、ユーザーが終わりにしたいと伝えるまで、1. から 3. までを繰り返す。
- 質問例（以下はあくまで例示です。実際の質問内容は打ち合わせシートの構造に基づいて動的に生成されます）：
  - 「何年生向けの授業を考えていますか？」と尋ね、[小1][小2][小3][小4][小5][小6][中1][中2][中3][高1][高2][高3][その他]の選択肢を提示する。
	- 選択肢は、打ち合わせの構造で定義されているものを使用する。
  - 「授業のテーマやトピックは何ですか？」と尋ね、ユーザーの自由回答を受け付ける。
- その他
  - "prior: 1"になっている項目は優先的に質問する。

## インタフェース

- 「通常モード」のみで動作する。「カスタマイズモード」では動作しない。
- 添付画像のように、画面右下に「AIアシスタント」ボタンを作る。
- ボタンをクリックすると、添付画像のように、チャットウィンドウを表示する。

## 実装

- 生成AIアシスタント機能は、JavaScriptで実装する。
- Azure OpenAIのAPIを利用して、GPT-5系（GPT-5, GPT-5.1, GPT-5.2のいずれか）を使用する。
- 「AIアシスタント」ボタンの付近に設定ボタン（config iconでよい）を設け、以下の情報を編集できるようにする。
  - エンドポイントとキー（機密情報なので入力内容はマスクする）
  - モデル選択（GPT-5, GPT-5.1, GPT-5.2のいずれかを選択可能にする）
  - 推論量（reasoning_effort: minimal, low, medium, high）※デフォルトはmedium
  - 冗長さ（verbosity: none, low, medium, high）※デフォルトはmedium
- Undo/Redo機能を実装する。最大20回分を保持する。
